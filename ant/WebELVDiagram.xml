<?xml version="1.0" encoding="UTF-8"?>

<project name="WebELVTool" default="jar" basedir="..">
    <description>
    	Jar all class files into one file to be run by the slicing tool.
    </description>
	
	<!-- Defining a list of directory names to be used -->
	<property name="targetDir" value="${basedir}/WebELVTool" />
	<property name="srcDir" value="${basedir}/src" />
	<property name="classDir" value="${basedir}/classes" />
	<property name="orgDir" value="${classDir}/org" />
	<property name="libDir" value="${basedir}/lib" />
	<property name="resourcesDir" value="${basedir}/resources" />
	
	
	<!-- Empty the direcotry. If nothing there, it should do nothing -->
	<target name="delete">
		<delete dir="${targetDir}" />
	</target>
	
	<!-- make a directory first. If it is there, it should do nothing -->
	<target name="mkdir" depends="delete">
		<mkdir dir="${targetDir}" /> 
		<mkdir dir="${targetDir}/resources" />
		<mkdir dir="${targetDir}/logs" />
	</target>

	<!-- path for including all jar files in library directory -->
	<path id="class.path">
		<fileset dir="${libDir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<!-- compile source code in specified src directory -->
	<target name="compile">
		<mkdir dir="${classDir}" />
		<javac includeantruntime="false" srcdir="${srcDir}" destdir="${classDir}" >
			<classpath refid="class.path" />
		</javac>
        </target>
	
	<!-- copy all files to the target directory -->
	<!-- Don't delete the targetDir since there is CVS information there -->
	<target name="jar" depends="compile">
		<jar destfile="${targetDir}/webELVTool.jar">
			<fileset dir="${classDir}">
				<include name="org/gk/util/**" />
				<include name="org/gk/schema/**" />
				<include name="org/gk/persistence/**" />
				<include name="org/gk/model/**" />
				<include name="org/gk/database/**" />
				<include name="org/gk/elv/**" />
				<include name="org/gk/gkEditor/**" />
				<include name="org/gk/graphEditor/**" />
			 	<include name="org/gk/pathwaylayout/**" />
			 	<include name="org/gk/property/**" />
			 	<include name="org/gk/render/**" />
				<include name="org/gk/database/util/**" />
				<include name="org/gk/slicing/**" />
				<include name="org/gk/convert/common/**" />
				<include name="org/gk/gsea/**" />
				<include name="org/gk/biosystems/**" />
				<include name="org/gk/qualityCheck/**" />
				<include name="org/gk/scripts/**" />
				<include name="org/gk/gkCurator/authorTool/**" />
			</fileset>
			<manifest>
				<!-- attribute name="Main-Class" value="org.gk.pathwaylayout.DiagramGeneratorFromDB" / -->
				<attribute name="Main-Class" value="org.gk.pathwaylayout.PredictedPathwayDiagramGeneratorFromDB" />
				<attribute name="Class-Path" value="mysql.jar jgraph.jar log4j.jar jdom.jar xerces.jar xml-apis.jar commons-lang.jar" />
			</manifest>
		</jar>
		<copy file="${libDir}/mysql-connector-java-5.0.8-bin.jar" tofile="${targetDir}/mysql.jar" />
		<copy file="${libDir}/jgraph.5.7.4.6.jar" tofile="${targetDir}/jgraph.jar" />
		<copy file="${libDir}/log4j-1.2.12.jar" tofile="${targetDir}/log4j.jar" />
		<copy file="${libDir}/jdom/jdom.jar" tofile="${targetDir}/jdom.jar" />
		<copy file="${libDir}/batik/xerces_2_5_0.jar" tofile="${targetDir}/xerces.jar" />
		<copy file="${libDir}/batik/xml-apis.jar" tofile="${targetDir}/xml-apis.jar" />
		<copy file="${libDir}/commons-lang-2.3.jar" tofile="${targetDir}/commons-lang.jar" />
		<copy file="${libDir}/itext-2.0.4.jar" tofile="${targetDir}/itext-2.0.4.jar" />
		<copy file="${basedir}/shell/runWebELVTool.sh" todir="${targetDir}" />
		<copy file="${resourcesDir}/log4j.properties" todir="${targetDir}/resources" />
		<copy file="${basedir}/shell/runDiagramDumper.sh" todir="${targetDir}" />
		<copy file="${basedir}/shell/runReactomeToBioSystems.sh" todir="${targetDir}" />
	</target>	
</project>  
